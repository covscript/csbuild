<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="*" Name="PRODUCT_NAME" Language="1033" Version="PRODUCT_VERSION" Manufacturer="Covariant Script Organization" UpgradeCode="197e3fe6-b2f4-4f7c-b94f-050ca0dd9a7d">
        <Package Id="*" Keywords="CovScript" Description="Covariant Script Runtime" Platform="PRODUCT_ARCH" InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

        <MajorUpgrade AllowSameVersionUpgrades="yes" DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

        <Media Id="1" Cabinet="Cab1.cab" EmbedCab="yes" />

        <Feature Id="CovScript" Title="Covariant Script" Level="1">
            <ComponentRef Id="ApplicationShortcut" />
            <ComponentGroupRef Id="Package" />
        </Feature>

        <Icon Id="icon.ico" SourceFile="SourceDir\icon.ico"/>
        <Property Id="ARPPRODUCTICON" Value="icon.ico" />

        <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />
        <UIRef Id="WixUI_FeatureTree" />
        <WixVariable Id="WixUILicenseRtf" Value="SourceDir\License.rtf" />

        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder">
                <Directory Id="INSTALLDIR" Name="CovScript" />
            </Directory>
            <Directory Id="ProgramMenuFolder" Name="Programs">
                <Directory Id="ApplicationProgramsFolder" Name="Covariant Script" />
            </Directory>
        </Directory>
    </Product>

    <Fragment>
        <DirectoryRef Id="INSTALLDIR">
            <Directory Id="dir03D70DE45D2AC78BF34AB918B2D1DBEA" Name="bin">
                <Component Id="cmpDC88EB415BE80B6C5004DD59CA5177D4" Guid="{212F3D98-962D-407D-9543-F0565E80D121}">
                    <File Id="fil6F2B2165818E97D673E89D6FEA3821F8" KeyPath="yes" Source="SourceDir\bin\cs.exe" />
                </Component>
                <Component Id="cmp802ECBB3D5A542900D4AB0E49FE7F126" Guid="{DA3B49DC-60CE-40F4-8E05-AC53A5F56D44}">
                    <File Id="fil232B4B0BF6B587BE176FE67E8269365B" KeyPath="yes" Source="SourceDir\bin\cspkg" />
                </Component>
                <Component Id="cmpCD52B7C70176CFE8B2BB6AFE60F125D4" Guid="{5A88C4D7-9C34-4B77-82CE-DEE63809700C}">
                    <File Id="fil9290242ED191254918CE5511AA2A1456" KeyPath="yes" Source="SourceDir\bin\cspkg.bat" />
                </Component>
                <Component Id="cmpC357076F88D4067CCC23470FBD0A15E8" Guid="{B7551381-91F9-4197-82B2-9E90194A81F8}">
                    <File Id="filC73006886FD2DA74BDE151F624A156D7" KeyPath="yes" Source="SourceDir\bin\cs_dbg.exe" />
                </Component>
                <Component Id="cmp522C4C291708D2FDECA4D5DC6DB82E8B" Guid="{46C51114-998D-416B-8522-4D594174BF12}">
                    <File Id="filC303E4A0BE13DF36DBD53B15D36F5F0C" KeyPath="yes" Source="SourceDir\bin\ecs" />
                </Component>
                <Component Id="cmpAC18366A67812F9E273B93AD1CF088E7" Guid="{ACBD9876-4355-4F7A-BE45-338294E4B3FB}">
                    <File Id="fil20DF7F5E15747994B5072C2F4EF9DBB5" KeyPath="yes" Source="SourceDir\bin\ecs.bat" />
                </Component>
            </Directory>
            <Directory Id="dir025855D6DAD50F5AAA378208F469CF18" Name="imports">
                <Component Id="cmp181E75EF6B9D2B86D16FA6287D426B62" Guid="{C34D5C6E-D0EE-4AA9-8CCE-DDA5FAD3F4C4}">
                    <File Id="filF0FFCAA3033F4C2ACD84C9D85F054F0B" KeyPath="yes" Source="SourceDir\imports\codec.cse" />
                </Component>
                <Component Id="cmp01918FE7CCA619B444F6C7F97257ABC8" Guid="{DFC35988-45C2-42BE-9FD6-FFA25BC7303E}">
                    <File Id="fil9C585E275B4FD18EAB9C23068CCAD522" KeyPath="yes" Source="SourceDir\imports\curl.cse" />
                </Component>
                <Component Id="cmp6E7DCDE339D2A94D71E9CE9EFDECB469" Guid="{1BAEB8CB-3A61-4B63-9A60-132CD1F8B04F}">
                    <File Id="fil6585C50B68B1609FD8A68FF2873A91B0" KeyPath="yes" Source="SourceDir\imports\process.cse" />
                </Component>
                <Component Id="cmpF0F3FE4DCAD76AF3A553D3C96672A83B" Guid="{3FB8D851-FAD1-4885-81CD-6736447B5A76}">
                    <File Id="filC9618A22832B33C3A14DAC5B00687931" KeyPath="yes" Source="SourceDir\imports\regex.cse" />
                </Component>
                <Component Id="cmpA59326D7085616E04C24F7295D011EE0" Guid="{8DE441E6-24B3-4236-BF3A-835BFF3B1F80}">
                    <File Id="fil258A0D3B838ED19EB04E6FE2FDB06042" KeyPath="yes" Source="SourceDir\imports\unicode.cse" />
                </Component>
            </Directory>
            <Directory Id="dir34269D035514C3D2F63BB0AAD4DAC456" Name="include">
                <Directory Id="dirE371CC046625EDF86ED09E5ACE6F9B6D" Name="covscript">
                    <Component Id="cmp1E4D0A0507E26CE652CA5407606DF0D7" Guid="{12621C37-FD48-42E1-A6ED-3CA157F09BA8}">
                        <File Id="filAE538846A405CE0D11ABE111CCEC8DF1" KeyPath="yes" Source="SourceDir\include\covscript\cni.hpp" />
                    </Component>
                    <Component Id="cmpD990ABE9DE5D36B165C59C0451207488" Guid="{002FDE0C-F058-4D72-8903-1937C9E45C06}">
                        <File Id="filED2F6EE6CC700DF8663B2D1DC856C591" KeyPath="yes" Source="SourceDir\include\covscript\covscript.hpp" />
                    </Component>
                    <Component Id="cmpC074E4ECF2E50E25E75937C88F7F8D55" Guid="{FBEC53D1-F59D-4B13-9E90-0B877697082B}">
                        <File Id="fil01B1739A9CDFF5A140EB45A69E7BEC06" KeyPath="yes" Source="SourceDir\include\covscript\dll.hpp" />
                    </Component>
                    <Directory Id="dirFF89A6DDA686BB4D00A0396DEC2C03CF" Name="core">
                        <Component Id="cmp759356F7E7007D10ED2DB01086FF0C1B" Guid="{3CA14F69-1CFF-4C4F-B8FA-8AF340551E4D}">
                            <File Id="fil75ABF3C45520DBAAF6781B0EEDF45D5D" KeyPath="yes" Source="SourceDir\include\covscript\core\cni.hpp" />
                        </Component>
                        <Component Id="cmpF27B253E2F23A7C74BB9542B7771445C" Guid="{91A70986-C37E-48CE-A904-CD4ADA0C37B8}">
                            <File Id="fil67EA99DF9694A4C1EF96A59DF41384DD" KeyPath="yes" Source="SourceDir\include\covscript\core\components.hpp" />
                        </Component>
                        <Component Id="cmp70004D5982F224C8775FD4916AC326FC" Guid="{3E634327-05EE-481B-94BC-83A472B243BA}">
                            <File Id="filE5CAA5283EAC4B20027378C4E04CF233" KeyPath="yes" Source="SourceDir\include\covscript\core\core.hpp" />
                        </Component>
                        <Component Id="cmp6C759F1B4A5D351A6EFAA51642DD3FFD" Guid="{71BE6127-B146-48EE-9759-A85F26CE79DB}">
                            <File Id="fil0ACA021BC3F353CE37F11516C5BA3378" KeyPath="yes" Source="SourceDir\include\covscript\core\definition.hpp" />
                        </Component>
                        <Component Id="cmpC5AA090049E9475529571F687F193474" Guid="{8CB108DB-2171-4F01-B426-E388C4FBE5E6}">
                            <File Id="filAEA7379C115934A994BCCD0536929158" KeyPath="yes" Source="SourceDir\include\covscript\core\variable.hpp" />
                        </Component>
                        <Component Id="cmpBF646A1D23C8EE43E47A422524DEC797" Guid="{3FA559D8-F44C-4C88-B0CF-C234DFD25AEF}">
                            <File Id="fil9B61658D0F11F8420EFB0FDAC537165D" KeyPath="yes" Source="SourceDir\include\covscript\core\version.hpp" />
                        </Component>
                    </Directory>
                    <Directory Id="dir41EA34F472A7D738E31732B5CA5040DB" Name="impl">
                        <Component Id="cmp4E261787A7E57472E9A620E876E6B67B" Guid="{6EAD91F5-BC22-4F68-BA9F-C6423458A8F3}">
                            <File Id="filF0D094DD0CD050C963711F1A2A86CEFB" KeyPath="yes" Source="SourceDir\include\covscript\impl\codegen.hpp" />
                        </Component>
                        <Component Id="cmp5E0CD9E0192FA3535C603388EF20E302" Guid="{F1D8A6DB-5C1C-481E-8B73-C9DA336612B0}">
                            <File Id="fil32032F92FF13DFA22093E35313E3F113" KeyPath="yes" Source="SourceDir\include\covscript\impl\compiler.hpp" />
                        </Component>
                        <Component Id="cmp0DA0F4138ADEB714000A283BA4C24584" Guid="{F90DCAFE-4C81-4083-89CF-728620838B24}">
                            <File Id="fil54D47B02ADE0162B3B471122F3EBB6AB" KeyPath="yes" Source="SourceDir\include\covscript\impl\impl.hpp" />
                        </Component>
                        <Component Id="cmp6DCCDDAFB95D95C536ED75E9D70E69CF" Guid="{2F5C0D53-A3D2-460A-910E-0AA7AEB56DE2}">
                            <File Id="fil4E8D04DC8D7868D5242B10F505AEB2D6" KeyPath="yes" Source="SourceDir\include\covscript\impl\runtime.hpp" />
                        </Component>
                        <Component Id="cmp44A72174B785183A8AFDD17E7D9DA7F5" Guid="{C0538BBD-A942-42CA-8EBB-27D56B96D841}">
                            <File Id="fil379945D3229FE6E77A58E25E9AED089E" KeyPath="yes" Source="SourceDir\include\covscript\impl\statement.hpp" />
                        </Component>
                        <Component Id="cmp8C5080D0DF8E0F98452450D77BF84095" Guid="{7CB00018-32CA-4337-A49C-D2E80555CE57}">
                            <File Id="fil4808BC85A1C5506A67A3BDF7160CCA95" KeyPath="yes" Source="SourceDir\include\covscript\impl\symbols.hpp" />
                        </Component>
                        <Component Id="cmp451EB3A119443E77376D87B227DD0689" Guid="{2F01A140-A46F-44CC-BD41-B8425A7585DD}">
                            <File Id="filD6C9F15E28D7AC8955C96646EB322965" KeyPath="yes" Source="SourceDir\include\covscript\impl\system.hpp" />
                        </Component>
                        <Component Id="cmp5E82D432CAB1D2A830145BEC18791920" Guid="{8B5A52B4-28BC-4209-8963-B88C2AAC22A1}">
                            <File Id="fil90EA7656AB16CC46E373450673B80887" KeyPath="yes" Source="SourceDir\include\covscript\impl\type_ext.hpp" />
                        </Component>
                    </Directory>
                </Directory>
                <Directory Id="dir8EE2C58D77D6DA6B2BA04A04A9BA7A93" Name="parallel_hashmap">
                    <Component Id="cmp8402AC770FEB73F0FC1B1B82BF6ED2C5" Guid="{DA1AB7FB-865B-47C8-9136-4B28FF216B96}">
                        <File Id="fil4B52D9A1B982287F9EE26FA5505A6E97" KeyPath="yes" Source="SourceDir\include\parallel_hashmap\btree.h" />
                    </Component>
                    <Component Id="cmpCF88201259787334447339D745B2FEB5" Guid="{175C627D-1AB7-4952-86D7-F4A642AB8F21}">
                        <File Id="filE8DCDECAD7256CBE5588D9566D3C9580" KeyPath="yes" Source="SourceDir\include\parallel_hashmap\meminfo.h" />
                    </Component>
                    <Component Id="cmp2D3CF922311B7EED1A34819473153A3B" Guid="{FB8A037F-AF48-4F4B-AB5A-7CDA7D861E71}">
                        <File Id="fil293DAE0F6D538F9A80EEBFC1FEEAEC45" KeyPath="yes" Source="SourceDir\include\parallel_hashmap\phmap.h" />
                    </Component>
                    <Component Id="cmp227D154C424C8E23FB07FAC0AC0940AE" Guid="{98ADF512-7715-4762-A62F-DD475392CE4E}">
                        <File Id="fil45C2F18D9E724417A87A85ABFC76400A" KeyPath="yes" Source="SourceDir\include\parallel_hashmap\phmap_base.h" />
                    </Component>
                    <Component Id="cmp6F4C4E1DC67CA7040F5C7603FFFFAF73" Guid="{840F306D-AAB6-4FD2-B12F-8C246A3C0503}">
                        <File Id="filB1F5E82892B5BC7EC6A7A222FB37FAB0" KeyPath="yes" Source="SourceDir\include\parallel_hashmap\phmap_bits.h" />
                    </Component>
                    <Component Id="cmp823DBBB09189DA9BB6AEAD5777C6292E" Guid="{65B31EB4-133C-476A-8A2A-C4A992220941}">
                        <File Id="fil64468A0DD83AED8050E8C25D6692474F" KeyPath="yes" Source="SourceDir\include\parallel_hashmap\phmap_config.h" />
                    </Component>
                    <Component Id="cmp28715F795D500E60283A2A3D68FBBBD5" Guid="{A2ABCEA0-67E4-4761-B53D-25D628E66B5B}">
                        <File Id="filAFE154C3BCCE2CB0843C2F0FEC719A4F" KeyPath="yes" Source="SourceDir\include\parallel_hashmap\phmap_dump.h" />
                    </Component>
                    <Component Id="cmpAE4622A5F31DAF51BFAF7326CCD52F00" Guid="{158FBCD1-0592-42E1-8E1C-3AD5B8A1C899}">
                        <File Id="fil333C4B28742E8E15591F7FFB99834D91" KeyPath="yes" Source="SourceDir\include\parallel_hashmap\phmap_fwd_decl.h" />
                    </Component>
                    <Component Id="cmpE3589FBD2A72CBAEDFF342AD479282C5" Guid="{F94E71F5-A2DD-4140-BE88-B30004169E3A}">
                        <File Id="fil7780102964ACC08A890BFAF72D74D099" KeyPath="yes" Source="SourceDir\include\parallel_hashmap\phmap_utils.h" />
                    </Component>
                </Directory>
            </Directory>
            <Directory Id="dir5D7C4FA608B02D34BB5BDAD566C26A85" Name="lib">
                <Component Id="cmpCF46CCBAEDFD37CF4216FF048C01F47B" Guid="{9007DA64-A0CA-4D4F-AAF7-65CD3491567E}">
                    <File Id="filBB12DE35F76F3638ACCAC6DB77DA0396" KeyPath="yes" Source="SourceDir\lib\libcovscript.a" />
                </Component>
                <Component Id="cmp28FDDF5CA3B2F5104BBE3782F73D2097" Guid="{D811A28A-F031-4D18-B9F4-3464FB45524D}">
                    <File Id="filE1B9DCBB57C16CF4EE231C05BD55CECA" KeyPath="yes" Source="SourceDir\lib\libcovscript_debug_sdk.a" />
                </Component>
                <Component Id="cmpE8169A7C2EFFDEB760D488BEDFC033A1" Guid="{EE5A596F-32B6-4DE6-A483-42A1E1659324}">
                    <File Id="fil1CF999814F2A7899153A9F6D1A24E294" KeyPath="yes" Source="SourceDir\lib\libcovscript_sdk.a" />
                </Component>
            </Directory>
            <Component Id="cmp84B8C16E2C764577AFD87553947EB121" Guid="{76B891EC-6D61-4822-95BE-415692B89953}">
                <File Id="fil7A3A32A9AE354BE1AAA4D3C477B9A4A7" KeyPath="yes" Source="SourceDir\csbuild.cmake" />
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="ApplicationProgramsFolder">
            <Component Id="ApplicationShortcut" Guid="{1BDEED99-E5C9-41B5-AC6B-CB01BD2E14C9}">
                <Environment Id="env932E884071DC47DFB2E24B51838B2459" Name="CS_DEV_PATH" Value="[INSTALLDIR]" Permanent="no" Part="last" Action="set" System="yes" />
                <Environment Id="env3F4BB476B6914C5BA187624DE6198E5B" Name="PATH" Value="[INSTALLDIR]bin" Permanent="no" Part="last" Action="set" System="yes" />
                <Shortcut Id="ApplicationStartMenuShortcut" Name="Covariant Script REPL" Description="Covariant Script Runtime" Arguments="-w -i &quot;[INSTALLDIR]imports&quot;" Target="[INSTALLDIR]bin\cs.exe" WorkingDirectory="INSTALLDIR" />
                <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
                <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Name="installed" Type="integer" Value="1" KeyPath="yes" />
            </Component>
        </DirectoryRef>
    </Fragment>

    <Fragment>
        <ComponentGroup Id="Package">
            <ComponentRef Id="cmpDC88EB415BE80B6C5004DD59CA5177D4" />
            <ComponentRef Id="cmp802ECBB3D5A542900D4AB0E49FE7F126" />
            <ComponentRef Id="cmpCD52B7C70176CFE8B2BB6AFE60F125D4" />
            <ComponentRef Id="cmpC357076F88D4067CCC23470FBD0A15E8" />
            <ComponentRef Id="cmp522C4C291708D2FDECA4D5DC6DB82E8B" />
            <ComponentRef Id="cmpAC18366A67812F9E273B93AD1CF088E7" />
            <ComponentRef Id="cmp181E75EF6B9D2B86D16FA6287D426B62" />
            <ComponentRef Id="cmp01918FE7CCA619B444F6C7F97257ABC8" />
            <ComponentRef Id="cmp6E7DCDE339D2A94D71E9CE9EFDECB469" />
            <ComponentRef Id="cmpF0F3FE4DCAD76AF3A553D3C96672A83B" />
            <ComponentRef Id="cmpA59326D7085616E04C24F7295D011EE0" />
            <ComponentRef Id="cmp1E4D0A0507E26CE652CA5407606DF0D7" />
            <ComponentRef Id="cmpD990ABE9DE5D36B165C59C0451207488" />
            <ComponentRef Id="cmpC074E4ECF2E50E25E75937C88F7F8D55" />
            <ComponentRef Id="cmp759356F7E7007D10ED2DB01086FF0C1B" />
            <ComponentRef Id="cmpF27B253E2F23A7C74BB9542B7771445C" />
            <ComponentRef Id="cmp70004D5982F224C8775FD4916AC326FC" />
            <ComponentRef Id="cmp6C759F1B4A5D351A6EFAA51642DD3FFD" />
            <ComponentRef Id="cmpC5AA090049E9475529571F687F193474" />
            <ComponentRef Id="cmpBF646A1D23C8EE43E47A422524DEC797" />
            <ComponentRef Id="cmp4E261787A7E57472E9A620E876E6B67B" />
            <ComponentRef Id="cmp5E0CD9E0192FA3535C603388EF20E302" />
            <ComponentRef Id="cmp0DA0F4138ADEB714000A283BA4C24584" />
            <ComponentRef Id="cmp6DCCDDAFB95D95C536ED75E9D70E69CF" />
            <ComponentRef Id="cmp44A72174B785183A8AFDD17E7D9DA7F5" />
            <ComponentRef Id="cmp8C5080D0DF8E0F98452450D77BF84095" />
            <ComponentRef Id="cmp451EB3A119443E77376D87B227DD0689" />
            <ComponentRef Id="cmp5E82D432CAB1D2A830145BEC18791920" />
            <ComponentRef Id="cmp8402AC770FEB73F0FC1B1B82BF6ED2C5" />
            <ComponentRef Id="cmpCF88201259787334447339D745B2FEB5" />
            <ComponentRef Id="cmp2D3CF922311B7EED1A34819473153A3B" />
            <ComponentRef Id="cmp227D154C424C8E23FB07FAC0AC0940AE" />
            <ComponentRef Id="cmp6F4C4E1DC67CA7040F5C7603FFFFAF73" />
            <ComponentRef Id="cmp823DBBB09189DA9BB6AEAD5777C6292E" />
            <ComponentRef Id="cmp28715F795D500E60283A2A3D68FBBBD5" />
            <ComponentRef Id="cmpAE4622A5F31DAF51BFAF7326CCD52F00" />
            <ComponentRef Id="cmpE3589FBD2A72CBAEDFF342AD479282C5" />
            <ComponentRef Id="cmpCF46CCBAEDFD37CF4216FF048C01F47B" />
            <ComponentRef Id="cmp28FDDF5CA3B2F5104BBE3782F73D2097" />
            <ComponentRef Id="cmpE8169A7C2EFFDEB760D488BEDFC033A1" />
            <ComponentRef Id="cmp84B8C16E2C764577AFD87553947EB121" />
        </ComponentGroup>
    </Fragment>
</Wix>